x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x

--- 第12章: Windows 2000/MEの脆弱性 ---

著者：Will

x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x


■0x01.) はじめに

　2005年4月19日にWindows2000にファイル選択のみで任意のスクリプトが実行さ
れる脆弱性が発見されました。「脆弱性って何？」という人のためにちょっと説
明。脆弱性とは、攻撃に悪用される可能性のある欠陥や仕様上の問題点のことを
指します。一般の人にとって、そのような脆弱性が原因の危険を身近に感じるこ
とは少ないでしょう。ならば、自分でその危険性を体験してみましょう。


■0x02.) 今回の脆弱性の原因

　Explorerはデフォルトで、選択されたファイルの詳細を表示します。そのとき
に名前がE-mailアドレスと類似しているかチェックして、そして、それをE-mail
アドレスだと判別した場合、そのE-mailアドレスへのリンクを張ります。そして、
そのリンクが任意のスクリプトコマンドの実行を可能にします。


■0x03.) 実際にスクリプトを実行させてみる

●Alertを表示
　ここでは、簡単な実験としてAlertを表示させてみましょう。

1：適当にファイルを作成します。

2：そのファイルを右クリックで選択して、プロパティを表示させます。そして、
「概要」タブの中の「作成者」欄に次の文字列を入力します。

-----
a@b' style='background-image:url(javascript:alert("Test"))'
----

3：[OK]ボタンを押してから、[F5]キーを押して、画面を更新させます。

4：これで準備は整いました。作成したファイルをクリックします。


●全画面で指定Web Pageを表示させる
　実験後は、[Alt]＋[Ctrl]＋[Del]でタスクマネージャを立ち上げて、全画面表
示されたウィンドウを閉じてください。

1：適当にファイルを作成します。

2：そのファイルを右クリックで選択して、プロパティを表示させます。そして、
「概要」タブの中の「作成者」欄に次の文字列を入力します。
-----
a@b' style='background-image:url(javascript:window.open("http://www.google.com/intl/ja/", "window_name", "fullscreen=1"));'
-----


3：[OK]ボタンを押してから、[F5]キーを押して、画面を更新させます。

4：これで準備は整いました。作成したファイルをクリックします。


■0x04.) この脆弱性の対応策

　現在のところMicrosoftからは修正パッチが公開されていないので、設定でしか
対応できません。対応策としては、エクスプローラのメニューの「ツール」の「フ
ォルダオプション」を選び、オプション画面の「全般」で「フォルダでWebコンテ
ンツを使う」から「従来のWindowsフォルダを使う」へ変更すればこの脆弱性を回
避できます。


■0x05.) まとめ

　このようにファイルにちょっとした編集をするだけでスクリプトを実行するこ
とができました。ところで、この脆弱性のどこが危険かというと、例えばこの脆
弱性を利用することによって強制的なワンクリック詐欺を行うことができたり、
またすべてのファイルの作成者の欄を改変するウイルスも作成することが可能で
す。プログラマーも人間ですのでミスをしてしまうこともあります。ゆえに脆弱
性はおそらくなくならないでしょう。そこで、私たち、使う側の人間がセキュリ
ティー意識を持つことが必要なのです


■0x06.) あとがき

　今回が初投書となります。テスト前なのにこのような文章を作っている私って
…。初めて書いたので、かなり読みにくい文章になっていると思いますが、編集
者の方が編集してすばらしく読みやすい文章になっていることでしょう。なんか
前のTaKa John Brunkhorst氏の文章に似てるな…。まぁいいか…。
